%-------------------------------------------------------------------------------
\section{Setting and Goals}
%-------------------------------------------------------------------------------

\begin{table*}[t!]
\centering
\begin{tabular}{ c p{.8\linewidth} }
\textbf{Symbol} & \textbf{Description} \\
\hline
    \vspace{6pt}
$d$ & a disguise corresponding to a developer-provided specification that can be applied or revealed via \sys's API\\
    \vspace{6pt}
\op{d} & an operation of disguise $d$ (either a removal, modification, or decorrelation)\\
    \vspace{6pt}
$p$ & an application principal, corresponding to a user ID in the application\\
    \vspace{6pt}
\pubk{p} & public key of $p$ \\
    \vspace{6pt}
\privk{p} & private key of $p$ \\
    \vspace{6pt}
\symk{pd} & symmetric key used to perform the second level of encryption of private tokens associated with principal $p$ produced by disguise $d$\\
    \vspace{6pt}
\tdata{pd} & token storing undisguised data associated with $p$ and produced by $d$.\\
    \vspace{6pt}
\tpriv{pdq} & token storing private key $\pubk{q}$ when \op{d} decorrelates data from $p$.\\
    \vspace{6pt}
\capa{pd} & capability required to locate encrypted \symk{pd} and \tdata{pd} records. 
\end{tabular}
\caption{Notation used to describe \sys's design.}
\label{tab:notation}
\end{table*}

Our design considers \emph{disguisable application systems}, which consist of a typical database-backed
application with an integrated disguising tool (\sys).
We assume the following elements:
\begin{itemize}
    \item $d$: a disguise that can be applied or revealed via \sys's API. Disguises modify and remove
    application data to hide revealing information. 
    \item $p$: an application principal, corresponding to a user ID in the application. 
\end{itemize}

\noindent
A disguisable application system operates on two categories of data:
\begin{enumerate}
    \item \emph{\textbf{Database Contents}}: The application reads and modifies database
        contents, which include visible, undisguised and currently-disguised daa.
        \sys modifies the data database contents when it applies and reveals disguises.
    \item \emph{\textbf{Disguise Tokens}}: Data generated by \sys's
        disguise application. Tokens encode information about disguise modifications to database
        contents, which \sys uses to compose disguises on top of one another or to reveal
        modifications done by a disguise. 
\end{enumerate}

%-------------------------------------------------------------------------------
\subsection{Threat Model}
%-------------------------------------------------------------------------------

\begin{table}[h]
\centering
    \begin{tabular}{ c c c }
        \textbf{Data} & \textbf{\sys?} & \textbf{p?}\\
\hline
        Database Contents & \checkmark & \checkmark \\
        Global Disguise Tokens & \checkmark & \checkmark \\
        Private Disguise Tokens & & \checkmark \\
        Set of Disguises Applied to Principal & & \checkmark \\
\end{tabular}
    \caption{Desired data access policies.}
\label{tab:accpriv}
\end{table}

An attacker compromises the web application and gains full access to the backend server.
%
This means that the attacker can access any data stored on the server, perform any actions the
application can perform, and access any information about disguises tracked by \sys.
%
The application and the data disguising tool, \sys, are in the same untrusted domain (\ie they
have the same threat model, and compromising one also compromises the other).
%

%
\sys operates in an honest-but-curious setting: even if compromised, \sys faithfully executes
its protocols.
%
Further, when it applies or reveals a disguise, \sys may temporarily
hold (in memory) plaintext token data, but is trusted to delete it once the disguise is
complete.
%
Finally, we assume standard security of public key and symmetric key primitives.

With this threat model, our goals are three-fold: 

\vspace{6pt}\noindent\textbf{\emph{(1) Security of Disguise Access Control.}}
We support disguises that require authentication as an admin, or as a user principal $p$, prior to being applied (or
revealed). Only a properly authenticated client can apply (and reveal) selective disguises
(and an attacker authenticated as the wrong party cannot).

\vspace{6pt}\noindent\textbf{\emph{(2) Security of Private Disguise Token Plaintext.}}
Tokens are optionally private to a single principal $p$. 
Only a client who has capability \capa{pd}
can find the ciphertexts corresponding to $p$'s tokens generated by disguise $d$; 
\sys stores a public key \pubk{p} for every principal, and ensures that 
only a client who knows the corresponding private key \privk{p} 
can decrypt these ciphertexts.
%
An attacker without either \privk{p} or \capa{pd} cannot access private disguise tokens created prior to time of compromise, even if authenticated as $p$.

\vspace{6pt}\noindent\textbf{\emph{(3) Security of Disguises Applied to Principal.}}
An attacker cannot learn the set of disguises applied to a principal. An attacker only learns a
disguise $d$ applied to principal $p$ if $p$ authorizes access to private token ciphertexts for $d$ with
\capa{pd}.

\vspace{6pt}\noindent
Table~\ref{tab:accpriv} illustrates our goal's data access policies.

\vspace{6pt}\noindent\textbf{\emph{Non-Goals.}}
\begin{itemize}
    \item Security of private tokens or disguise access control when an attacker has prior snapshots of system data.
    \item Security of disguise access control if an attacker authenticates as a principal $p$.
    \item Security of $p$'s private tokens and applied disguises if \privk{p} is compromised.  
    \item Security of $p$'s private tokens from $d$ and knowledge that $d$ disguised $p$ if an authorized client with \privk{p} grants \sys access to tokens from $d$. 
    \item Security of token metadata such as the number of disguise applied to, or number of tokens associated with, a particular principal $p$.
    \item Privacy guarantees about post-disguised data: \sys simply
        applies a disguise according to the developer-provided specification.  For example, a
        disguise may not modify data that leaks the writer's name (e.g., by leaving post content
        unmodified)
    \item Recognition of disguised application data objects as disguised. For example, the author of a
        paper may be replaced with ``anonFox,'' leaking information that the paper has been
        disguised.
\end{itemize}
