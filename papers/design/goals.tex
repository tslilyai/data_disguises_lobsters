%-------------------------------------------------------------------------------
\section{Setting and Goals}
%-------------------------------------------------------------------------------

\begin{table*}[t!]
\centering
\begin{tabular}{ c p{.8\linewidth} }
\textbf{Symbol} & \textbf{Description} \\
\hline
    \vspace{6pt}
$p$ & an application principal, corresponding to a user ID in the application\\
    \vspace{6pt}
$d$ & an instance of a disguise specification (developer-provided) that can be applied or revealed by a
    principal via \sys's API\\
    \vspace{6pt}
\op{d} & an operation specified as part of disguise $d$ (either a removal, modification, or decorrelation)\\
    \vspace{6pt}
\capa{pd} & capability required to grant \sys permissions to compose on top of disguise $d$'s
    updates, or reveal updates applied by disguise $d$. Permissions are associated with some
    principal $p$.\\
    \vspace{6pt}
\pubk{p} & public key of $p$, used to encrypt \tokk{pd} and \tpriv{pq} \\
    \vspace{6pt}
\privk{p} & private key of $p$ \\
    \vspace{6pt}
\addr{pd} & address at which encrypted \tokk{pd} and \tdata{pd} ciphertexts are located\\
    \vspace{6pt}
\tokk{pd} & symmetric key used to perform encrypt \tdata{pd}\\
    \vspace{6pt}
\tdata{pd} & data token storing undisguised data associated with $p$ prior to application of $d$.\\
    \vspace{6pt}
\tpriv{pq} & private key token storing the private key $\pubk{q}$ for a pseudoprincipal $q$ created
    when some disguise decorrelates data from $p$.\\
    \end{tabular}
\caption{Notation used to describe \sys's design.}
\label{tab:notation}
\end{table*}

Our design considers \emph{disguisable application systems}, which consist of a typical database-backed
application with an integrated disguising tool (\sys).
We assume the following elements:
\begin{itemize}
    \item $p$: an application principal, corresponding to a user ID in the application. 
    \item $d$: an instance of a disguise specification that can be applied or revealed by a principal via \sys's
        API. Invoking a disguise modifies and removes application data to hide revealing information.
\end{itemize}

\noindent
A disguisable application system operates on two categories of data:
\begin{enumerate}
    \item \emph{\textbf{Database Contents}}: The application reads and writes database
        contents, which include visible, undisguised and currently-disguised data.
        \sys modifies the data database contents when it applies and reveals disguises.
    \item \emph{\textbf{Permissions}}: \sys produces a set of permissions when it applies a
        disguise. These permissions allow \sys to compose disguises on top of one another, or to
        reveal the updates done by a disguise.
        %}\emph{\textbf{Disguise Tokens}}: Data generated by \sys's
        %disguise application. Tokens encode information about disguise modifications to database
        %contents, which \sys uses to compose disguises on top of one another or to reveal
        %modifications done by a disguise. 
\end{enumerate}

%-------------------------------------------------------------------------------
\subsection{Threat Model}
%-------------------------------------------------------------------------------

%
Data disguises seek to protect user information in a web application against external observation
and service compromise.
%
\sys, our data disguising framework, links into the web application as a library.
%
An attacker who compromises the web application and gains full access to the server therefore
can access any data stored, perform any actions the application can perform, and access any
disguise metadata.
%

%
A data disguise guarantees that the disguised data is hidden from any future attackers unless
explicitly revealed.
%
In particular, an attacker who compromises \sys at time $t$ learns \emph{nothing but}:
\begin{enumerate}[nosep]
  \item the (plaintext) contents of the application database at or after time $t$;
  \item the disguises invoked, and the identity of the principals invoking them, after time $t$; and
  \item the results of revealing, after time $t$, disguises applied prior to $t$.
\end{enumerate}
%
We make standard assumptions about the security of cryptographic primitives.
%

%
\sys operates in an honest-but-curious setting: even if compromised, \sys faithfully executes
its protocols, but the attacker can observe any plaintext data handled as well as the behavior
of the disguise.
%

\subsection{Security Goals}

With this threat model, our goals are three-fold: 

\vspace{6pt}\noindent\textbf{\emph{(1) Security of Disguise Access Control.}}
We support disguises that require authentication as an admin, or as a user principal $p$, prior to being applied (or
revealed). Only a properly authenticated client can apply (and reveal) selective disguises
(and an attacker authenticated as the wrong party cannot).

\vspace{6pt}\noindent\textbf{\emph{(2) Security of Private Disguise Permissions.}}
Permissions are optionally private to a single principal $p$. 
Only a client who has the correct capability \capa{pd} can grant \sys permissions private to $p$ generated
by disguise $d$.
%can find the ciphertexts corresponding to $p$'s tokens generated by disguise $d$; 
%\sys stores a public key \pubk{p} for every principal, and ensures that 
%only a client who knows the corresponding private key \privk{p} 
%can decrypt these ciphertexts.
%
An attacker without \capa{pd} cannot access private disguise tokens created prior to time of compromise, even if authenticated as $p$.

\vspace{6pt}\noindent\textbf{\emph{(3) Security of Invoked Disguises Metadata.}}
An attacker cannot learn the set of disguises that have disguised a principal's data. An attacker only learns a
disguise $d$ applied to principal $p$ if a client grants \sys access to $p$'s permissions for $d$ by
providing \capa{pd}.
%$p$ authorizes access to private token ciphertexts for $d$ with
%\capa{pd}.

\vspace{6pt}\noindent\textbf{\emph{Non-Goals.}}
\begin{itemize}
    \item Security of private permissions or disguise access control when an attacker has prior snapshots of system data.
    \item Security of disguise access control if an attacker authenticates as a principal $p$.
    \item Security of $p$'s private permissions and applied disguises if \privk{p} is compromised.  
    \item Security of $p$'s private permissions from $d$ and knowledge that $d$ disguised $p$ if an
        authorized client with \capa{pd} grants \sys access to $p$'s permissions from $d$. 
    \item Security of permission metadata such as the number of disguises applied to, or number of
        permissions associated with, a particular principal $p$.
    \item Privacy guarantees about post-disguised data: \sys simply
        applies a disguise according to the developer-provided specification.  For example, a
        disguise may not modify data that leaks the writer's name (e.g., by leaving post content
        unmodified)
    \item Recognition of disguised application data objects as disguised. For example, the author of a
        paper may be replaced with ``anonFox,'' leaking information that the paper has been
        disguised.
\end{itemize}

%\vspace{6pt}\noindent\textbf{\emph{(2) Security of Private Disguise Token Plaintext.}}
%Tokens are optionally private to a single principal $p$. 
%Only a client who has capability \capa{pd}
%can find the ciphertexts corresponding to $p$'s tokens generated by disguise $d$; 
%\sys stores a public key \pubk{p} for every principal, and ensures that 
%only a client who knows the corresponding private key \privk{p} 
%can decrypt these ciphertexts.
%%
%An attacker without either \privk{p} or \capa{pd} cannot access private disguise tokens created prior to time of compromise, even if authenticated as $p$.


%\begin{table}[h]
%\centering
%    \begin{tabular}{ c c c }
%        \textbf{Data} & \textbf{\sys?} & \textbf{p?}\\
%\hline
%        Database Contents & \checkmark & \checkmark \\
%        Global Disguise Tokens & \checkmark & \checkmark \\
%        Private Disguise Tokens & & \checkmark \\
%        Set of Disguises Applied to Principal & & \checkmark \\
%\end{tabular}
%    \caption{Desired data access policies.}
%\label{tab:accpriv}
%\end{table}

