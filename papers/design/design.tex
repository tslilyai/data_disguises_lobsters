%-------------------------------------------------------------------------------
\section{Overview}
%-------------------------------------------------------------------------------

Our design considers \emph{disguisable application systems}, which consist of a typical database-backed
application and a disguising tool (\sys) operating alongside the application.
This setting assumes the following elements:
\begin{table}[h]
\centering
\begin{tabular}{ c p{.9\linewidth} }
$d$ & a disguise that can be applied or reversed via \sys's API \\
$p$ & an application principal, which owns some data
    objects in the database (\eg a row in an \texttt{address} table).
%
This is typical of social network sites such as Facebook or Reddit; and other web applications that
tie functionality to user accounts (\eg ecommerce or bank applications).\\
\user{p} & external users of the application (potentially contacting the application via
    multiple different clients, such as a mobile and computer web browser).
    \user{p} creates $p$'s account, and can later authenticate as $p$.\\
\end{tabular}
\end{table}

\noindent
In normal database-backed applications, the application database contents completely capture data
held by the system: the application acts as the sole creator and updater of database contents. 
A disguisable application system, in contrast, operates on three different categories of data
(stored separately):
\begin{enumerate}
    \item \emph{\textbf{Database Contents}}: The application creates and updates its database
        contents as in the typical non-disguisable setting. \sys also can read and write
        the database to apply and reverse disguises.
    \item \emph{\textbf{Disguise History}}: Data about which disguises have been applied or
        reversed, used to compose disguises on top of one another.
    \item \emph{\textbf{Disguise Tokens}}: Data produced as a byproduct by disguise application.
        Tokens encode information about disguise modifications to database contents, and are used by
        \sys to compose disguises on top of one another or reverse a disguise's modifications.
\end{enumerate}

%-------------------------------------------------------------------------------
\subsection{Security Goals}
%-------------------------------------------------------------------------------
We assume an attacker who, after compromising the system, can perform any actions the
application or \sys can perform, and access any data the application or \sys can access.

\sys itself is honest but curious: when applying or reversing a disguise, \sys may temporarily
hold (in memory) plaintext token data, as well as private or symmetric keys, but is trusted to
forget them once the disguise action is complete. 
Finally, we assume standard security of public key and symmetric key primitives~\note{under a random
oracle model?}.

With this threat model, our goals are three-fold: 

\vspace{6pt}\noindent\textbf{\emph{(1) Security of Restricted Disguise Application.}}
We support disguises that require authentication as a principal $p$ prior to being
applied (or reversed). If so, only a client authenticated for principal $p$ can apply (and reverse) this disguise (and an attacker unauthenticated as $p$ cannot).

\vspace{6pt}\noindent\textbf{\emph{(2) Security of Private Disguise Tokens.} }
Tokens are optionally private to a single principal $p$, such that only \user{p} can authorize
access to these tokens. An attacker who is not \user{p} cannot
authorize or access private disguise tokens created prior to compromise, even if authenticated as $p$.

\vspace{6pt}\noindent\textbf{\emph{(3) Security of Private Disguise Token Metadata.}}
An attacker cannot learn how many private disguise tokens created prior to compromise are associated with a principal $p$'s data.

\vspace{6pt}\noindent\textbf{\emph{Non-Goals.}}
\begin{itemize}
    \item Security of private tokens or restricted disguises when an attacker has prior snapshots of system data.
    \item Security of restricted disguise application if an attacker authenticates as the principal.
    \item Security of $p$'s private tokens and token metadata if \user{p} authorizes access to these
        tokens, or if an attacker compromises \user{p}.
    \item Any unlinkability guarantees after disguise application. A disguise may leave implicit
        correlations between pieces of data and a principal (e.g., a comment that mentions the authorâ€™s name).
\end{itemize}

%-------------------------------------------------------------------------------
\subsection{Strawman: Security in an Open Setting}
%-------------------------------------------------------------------------------
In the \emph{open setting}, no type of data is kept hidden from \sys. In particular, the different data
types have the following access policies and affect each category of data as follows:

\begin{table}[h]
\centering
    \begin{tabular}{ c c c}
        \textbf{Data Type} & \textbf{\sys Access} & \textbf{\user{p} Access}\\
\hline
        Database Contents & Yes & Yes \\
        Disguise History & Yes & Yes \\
        Disguise Tokens & Yes & Yes \\
\end{tabular}
\caption{Access to different data types in the open setting.}
\label{tab:accopen}
\end{table}

\begin{table}[h]
\centering
    \begin{tabular}{ p{0.2\linewidth} p{.8\linewidth}}
        \textbf{Data Type} & \textbf{Disguise Effect}\\
\hline
        Database Contents & \sys modifies database contents, converting database rows to disguised
        versions according to the disguise specification.        
        \\
        Disguise History & \sys appends a record of the disguise action to the history.\\
        Disguise Tokens & Each disguise database modification generates a token recording the
        modifictaion, which \sys saves in plaintext.\\
\end{tabular}
\caption{Effects of a disguise split by data type in the open setting.}
\label{tab:disopen}
\end{table}



%-------------------------------------------------------------------------------
\subsection{Security in a Private Setting}
%-------------------------------------------------------------------------------

\begin{table}[h!]
\centering
    \begin{tabular}{ c c c}
        \textbf{Data Type} & \textbf{\sys Access} & \textbf{\user{p} Access}\\
\hline
        Database Contents & Yes & Yes \\
        Disguise History & Yes & Yes \\
        Disguise Tokens & & Yes \\
\end{tabular}
\caption{Accessiblity of different data types in the open setting}
\label{tab:accopen}
\end{table}


