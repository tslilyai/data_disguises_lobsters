%-------------------------------------------------------------------------------
\section{Overview}
%-------------------------------------------------------------------------------

Our design considers \emph{disguisable application systems}, which consist of a typical database-backed
application and a disguising tool (\sys) operating alongside the application.
This setting assumes the following elements:
\begin{table}[h]
\centering
\begin{tabular}{ c p{.9\linewidth} }
$d$ & a disguise that can be applied or reversed via \sys's API \\
$p$ & an application principal, which owns some data
    objects in the database (\eg a row in an \texttt{address} table).
%
This is typical of social network sites such as Facebook or Reddit; and other web applications that
tie functionality to user accounts (\eg ecommerce or bank applications).\\
\user{p} & external users of the application (potentially contacting the application via
    multiple different clients, such as a mobile and computer web browser).
    \user{p} creates $p$'s account, and can later authenticate as $p$.\\
\end{tabular}
\end{table}

\noindent
In normal database-backed applications, the application database contents completely capture data
held by the system: the application acts as the sole creator and updater of database contents. 
A disguisable application system, in contrast, operates on three different categories of data
(stored separately):
\begin{enumerate}
    \item \emph{\textbf{Database Contents}}: The application reads and modifies database
        contents, which include visible, undisguised and currently-disguised daa.
        \sys modifies the data database contents when it applies and reveals disguises.
    \item \emph{\textbf{Disguise History}}: Data about which disguises \sys has applied or
        reversed, used for revealing and to compose disguises on top of one another.
    \item \emph{\textbf{Disguise Tokens}}: Application-inaccessible data generated by \sys's
        disguise application. Tokens encode information about disguise modifications to database
        contents, and \sys uses them to compose disguises on top of one another or to reveal a
        disguise.
\end{enumerate}

%-------------------------------------------------------------------------------
\subsection{Security Goals}
%-------------------------------------------------------------------------------
We assume an attacker who, after compromising the system, can perform any actions the
application or \sys can perform, and access any data the application or \sys can access.

\sys itself is honest but curious: when applying or reversing a disguise, \sys may temporarily
hold (in memory) plaintext token data, as well as private or symmetric keys, but is trusted to
forget them once the disguise action is complete. 
Finally, we assume standard security of public key and symmetric key primitives.

With this threat model, our goals are three-fold: 

\vspace{6pt}\noindent\textbf{\emph{(1) Security of Restricted Disguise Application.}}
We support disguises that require authentication as a principal $p$ prior to being
applied (or reversed). If so, only a client authenticated for principal $p$ can apply (and reverse) this disguise (and an attacker unauthenticated as $p$ cannot).

\vspace{6pt}\noindent\textbf{\emph{(2) Security of Private Disguise Tokens.} }
Tokens are optionally private to a single principal $p$, such that only \user{p} can authorize
access to these tokens. An attacker who is not \user{p} cannot
authorize or access private disguise tokens created prior to compromise, even if authenticated as $p$.
\ms{Don't understand this; seems self-contradictory? If \user{p} is authenticated as $p$, they surely speak-for $p$ and can access its data?}
\lyt{This harkens back to when we decided \user{p} needs an additional capability to authorize token
access (\eg decryption with a private key): authentication is not sufficient.}

\vspace{6pt}\noindent\textbf{\emph{(3) Security of Private Disguise Token Metadata.}}
An attacker cannot learn how many private disguise tokens created prior to compromise are associated with a principal $p$'s data.

\vspace{6pt}\noindent\textbf{\emph{Non-Goals.}}
\begin{itemize}
    \item Security of private tokens or restricted disguises when an attacker has prior snapshots of system data.
    \item Security of restricted disguise application if an attacker authenticates as the principal.
    \item Security of $p$'s private tokens and token metadata if \user{p} authorizes access to these
        tokens, or if an attacker compromises \user{p}.\ms{See above; is there some subtle difference between \user{p} and $p$ that I'm missing?}
    \item Unlinkability via unmodified data contents after disguising. A disguise may leave explicit correlations
        between pieces of data and a principal (e.g., a comment that mentions the authorâ€™s name) as part
        of database contents that the disguise leaves alone.
\end{itemize}

%-------------------------------------------------------------------------------
\subsection{Strawman: Security in an Open Setting}
%-------------------------------------------------------------------------------
In the \emph{open setting}, no type of data is kept hidden from \sys. Table~\ref{tab:accopen} shows
the different data types access policies, and Table~\ref{tab:disopen} describes the effects of a
disguise on each type of data.

\begin{table}[h]
\centering
    \begin{tabular}{ c c c c }
        \textbf{Data} & \textbf{App Access} & \textbf{\sys Access} & \textbf{\user{p} Access}\\
\hline
        Database Contents & \checkmark & \checkmark & \checkmark \\
        Disguise History & \checkmark & \checkmark & \checkmark \\
        Disguise Tokens & & \checkmark & \checkmark \\
\end{tabular}
\caption{Data access policies.}
\label{tab:accopen}
\end{table}

\begin{table}[h]
\centering
    \begin{tabular}{ p{0.2\linewidth} p{.8\linewidth}}
        \textbf{Data} & \textbf{Disguise Effect}\\
\hline
        Database Contents & \sys modifies database contents, converting database rows to disguised
        versions according to the disguise specification.        
        \\
        Disguise History & \sys appends a record of the disguise action to the history.\\
        Disguise Tokens & Each disguise database modification generates a token recording the
        modification, which \sys saves in plaintext.\\
\end{tabular}
\caption{Effects of a disguise.}
\label{tab:disopen}
\end{table}

An open setting can achieve only security goal (1) by co-opting application
authentication logic to authenticate a principal prior to applying a disguise.
However, clearly an open setting fails to support private disguise tokens or hide token metadata: an
attacker who compromises \sys can read all generated tokens.
To meet all security goals, we move to a private setting, in which \sys uses cryptographic
primitives to render tokens inaccessible to \sys without permission from \user{p}.

%-------------------------------------------------------------------------------
\subsection{Security in a Private Setting}
%-------------------------------------------------------------------------------

\begin{table}[h!]
\centering
    \begin{tabular}{ c c c}
        \textbf{Data} & \textbf{\sys Access} & \textbf{\user{p} Access}\\
\hline
        Database Contents & Yes & Yes \\
        Disguise History & Yes & Yes \\
        Disguise Tokens & & Yes \\
\end{tabular}
\caption{Accessiblity of different data types in the open setting}
\label{tab:accopen}
\end{table}


